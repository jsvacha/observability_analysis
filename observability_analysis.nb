(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     84169,       2048]
NotebookOptionsPosition[     78889,       1964]
NotebookOutlinePosition[     79281,       1980]
CellTagsIndexPosition[     79238,       1977]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[TextData[StyleBox["Observability Analysis", "Title"]], "Text",
 CellChangeTimes->{{3.751113084908333*^9, 
  3.75111308947259*^9}},ExpressionUUID->"f394c52c-92c2-4904-b692-\
f42fc6e2de3d"],

Cell["Author: James Svacha (jsvacha@seas.upenn.edu)", "Text",
 CellChangeTimes->{{3.751117946916654*^9, 3.751117948521515*^9}, {
  3.7511179874061403`*^9, 
  3.751118000478374*^9}},ExpressionUUID->"c7d5ddad-8ade-4b71-9428-\
375a1259f787"],

Cell["\<\
This Mathematica document carries out the observability analysis introduced \
in our work, 
\[OpenCurlyDoubleQuote]Inertial Yaw-Independent Velocity And Attitude \
Estimation for High Speed Quadrotor Flight\[CloseCurlyDoubleQuote]. \
\>", "Text",
 CellChangeTimes->{{3.751113106398714*^9, 3.751113191979947*^9}, {
  3.75111772611495*^9, 
  3.751117726375012*^9}},ExpressionUUID->"eb048bfe-27f4-4cba-82b7-\
1dc2e90a517d"],

Cell[CellGroupData[{

Cell["Rotation Parameterization", "Section",
 CellChangeTimes->{{3.751113576290595*^9, 
  3.7511135817982063`*^9}},ExpressionUUID->"074b8c9b-476d-4d68-9aaa-\
1187533a5261"],

Cell["\<\
This section carries out the rotation parameterization, with the goal being \
to define the rotation matrix\
\>", "Text",
 CellChangeTimes->{{3.751113586133277*^9, 3.7511136138659773`*^9}, {
  3.7511140439982452`*^9, 
  3.751114045313675*^9}},ExpressionUUID->"8a73ebba-5df7-4271-b4c3-\
04d996b8e788"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"z", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"2", "*", 
       RowBox[{
        RowBox[{"s1", "[", "t", "]"}], "/", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{
           RowBox[{"s1", "[", "t", "]"}], "^", "2"}], "+", 
          RowBox[{
           RowBox[{"s2", "[", "t", "]"}], "^", "2"}]}], ")"}]}]}], ",", 
      RowBox[{"2", "*", 
       RowBox[{
        RowBox[{"s2", "[", "t", "]"}], "/", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{
           RowBox[{"s1", "[", "t", "]"}], "^", "2"}], "+", 
          RowBox[{
           RowBox[{"s2", "[", "t", "]"}], "^", "2"}]}], ")"}]}]}], ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{
          RowBox[{"s1", "[", "t", "]"}], "^", "2"}], "-", 
         RowBox[{
          RowBox[{"s2", "[", "t", "]"}], "^", "2"}]}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{
          RowBox[{"s1", "[", "t", "]"}], "^", "2"}], "+", 
         RowBox[{
          RowBox[{"s2", "[", "t", "]"}], "^", "2"}]}], ")"}]}]}], "}"}]}], 
   ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"body", "-", 
    RowBox[{
    "fixed", " ", "z", " ", "vector", " ", "in", " ", "local", " ", "yawed", 
     " ", "frame"}]}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.726328002756528*^9, 3.726328006281311*^9}, {
   3.726328328878016*^9, 3.726328405909541*^9}, 3.7263325650679703`*^9, {
   3.7263407232138*^9, 3.726340752754017*^9}, {3.744910717398081*^9, 
   3.744910771764844*^9}, {3.745162521049766*^9, 3.745162521068636*^9}, {
   3.751113329013053*^9, 3.751113403089953*^9}, {3.751114130472727*^9, 
   3.751114157826323*^9}, {3.751550057917221*^9, 3.751550079797533*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"9f38658d-6ee7-45e4-8dbf-0b56336ac469"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ctilt", "=", 
    RowBox[{"z", "[", 
     RowBox[{"[", "3", "]"}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"cosine", " ", "of", " ", "tilt", " ", "angle"}], " ", 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.7263284269280987`*^9, 3.726328457828991*^9}, 
   3.726332566960198*^9, {3.751113408278281*^9, 3.7511134233389482`*^9}, {
   3.7511136712062597`*^9, 3.751113682211027*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"f267fd17-b3a2-414c-9932-2e9c7b1fea4a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"stiltu", "=", 
    RowBox[{"Cross", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", "z"}], "]"}]}], ";"}], 
  " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "sine", " ", "of", " ", "tilt", " ", "angle", " ", "multiplied", " ", "by",
     " ", "tilt", " ", "axis"}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.726328566590226*^9, 3.7263285960659237`*^9}, 
   3.726329277853959*^9, 3.7263325679014072`*^9, {3.7511136682907763`*^9, 
   3.751113697423993*^9}},
 CellLabel->"In[3]:=",ExpressionUUID->"55f57c85-8a69-4b57-9c36-87bebbf3eac8"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"stilt", "=", 
    RowBox[{"Simplify", "[", 
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"stiltu", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "^", "2"}], "+", 
       RowBox[{
        RowBox[{"stiltu", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "^", "2"}]}], "]"}], "]"}]}], ";"}], 
  " ", 
  RowBox[{"(*", " ", 
   RowBox[{"sine", " ", "of", " ", "tilt", " ", "angle"}], " ", 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.72632860286331*^9, 3.726328629650052*^9}, {
   3.72632892584408*^9, 3.726328929756547*^9}, {3.72632911083419*^9, 
   3.7263291113318987`*^9}, {3.7263292834378223`*^9, 3.7263292873112593`*^9}, 
   3.726332568876371*^9, {3.75111370018631*^9, 3.751113711596677*^9}},
 CellLabel->"In[4]:=",ExpressionUUID->"35effb2f-0e43-44f5-b8ba-1c933b005854"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"u", "=", 
    RowBox[{"Simplify", "[", 
     RowBox[{"stiltu", "/", "stilt"}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"tilt", " ", "axis"}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.726328942595022*^9, 3.7263289570932837`*^9}, {
   3.726329100832108*^9, 3.7263291014747963`*^9}, {3.726329293728526*^9, 
   3.726329298995756*^9}, 3.726332570055925*^9, {3.751113718947773*^9, 
   3.751113732555915*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"433d4622-7eab-4a78-a5e2-ac6361e3e096"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"uhat", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"-", 
         RowBox[{"u", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], ",", 
        RowBox[{"u", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"u", "[", 
         RowBox[{"[", "3", "]"}], "]"}], ",", "0", ",", 
        RowBox[{"-", 
         RowBox[{"u", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"u", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ",", 
        RowBox[{"u", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", "0"}], "}"}]}], "}"}]}], ";"}], 
  " ", 
  RowBox[{"(*", " ", 
   RowBox[{"skew", "-", 
    RowBox[{"symmetric", " ", "tilt", " ", "axis"}]}], " ", "*)"}]}]], "Input",\

 CellChangeTimes->{{3.726329692316956*^9, 3.72632972948598*^9}, 
   3.7263325723178596`*^9, {3.751113735659533*^9, 3.751113742833522*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"7b5a3a50-a507-4f3c-834f-07c3a9848814"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"rtilt", "=", 
    RowBox[{"Simplify", "[", 
     RowBox[{
      RowBox[{"IdentityMatrix", "[", "3", "]"}], "+", 
      RowBox[{"stilt", "*", "uhat"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "ctilt"}], ")"}], "*", 
       RowBox[{"uhat", ".", "uhat"}]}]}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"tilt", " ", "rotation", " ", "matrix"}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.726329739465176*^9, 3.726329786898654*^9}, 
   3.726332576648033*^9, {3.726343387379507*^9, 3.7263433880497913`*^9}, {
   3.751113745218272*^9, 3.751113758933857*^9}, {3.751114187697257*^9, 
   3.7511141884746323`*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"24865bb4-33b7-4573-a9ab-eef82c207cf5"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ryaw", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Cos", "[", 
         RowBox[{"\[Psi]", "[", "t", "]"}], "]"}], ",", 
        RowBox[{"-", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Psi]", "[", "t", "]"}], "]"}]}], ",", "0"}], "}"}], ",", 
      
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Sin", "[", 
         RowBox[{"\[Psi]", "[", "t", "]"}], "]"}], ",", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Psi]", "[", "t", "]"}], "]"}], ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"yaw", " ", "rotation", " ", "matrix"}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.7449061838714113`*^9, 3.744906215148142*^9}, {
  3.7449107847807302`*^9, 3.744910808353245*^9}, {3.7451625210889273`*^9, 
  3.745162521096199*^9}, {3.7511137617055483`*^9, 3.751113762900281*^9}, {
  3.7511137987872047`*^9, 3.75111380355768*^9}, {3.75111416931253*^9, 
  3.751114170211876*^9}, {3.7515501859358253`*^9, 3.751550194804178*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"f21e1ac9-836c-4baf-907f-ea75b03633ab"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"r", "=", 
    RowBox[{"ryaw", ".", "rtilt"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"rotation", " ", "of", " ", "body"}], "-", 
    RowBox[{
    "fixed", " ", "frame", " ", "relative", " ", "to", " ", "inertial", " ", 
     "frame"}]}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.744906259859878*^9, 3.7449062625214243`*^9}, {
  3.751113764885634*^9, 3.751113794364747*^9}, {3.751114057106688*^9, 
  3.751114064042938*^9}, {3.75111417305726*^9, 3.751114178030452*^9}, {
  3.751551963280176*^9, 3.7515519641999197`*^9}, {3.751552099644808*^9, 
  3.751552100154354*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"35726f7d-bb5e-4bf9-ae30-e9e98e696b5a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "[", "r", "]"}]], "Input",
 CellChangeTimes->{{3.7511140661390333`*^9, 3.751114068206604*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"9278849e-4d0c-4eb7-b6d6-73a389af6b01"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       FractionBox[
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Psi]", "[", "t", "]"}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           SuperscriptBox[
            RowBox[{"s1", "[", "t", "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"s2", "[", "t", "]"}], "2"]}], ")"}]}], 
        RowBox[{"1", "+", 
         SuperscriptBox[
          RowBox[{"s1", "[", "t", "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"s2", "[", "t", "]"}], "2"]}]], "+", 
       FractionBox[
        RowBox[{"2", " ", 
         RowBox[{"s1", "[", "t", "]"}], " ", 
         RowBox[{"s2", "[", "t", "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Psi]", "[", "t", "]"}], "]"}]}], 
        RowBox[{"1", "+", 
         SuperscriptBox[
          RowBox[{"s1", "[", "t", "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"s2", "[", "t", "]"}], "2"]}]]}], 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"2", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Psi]", "[", "t", "]"}], "]"}], " ", 
          RowBox[{"s1", "[", "t", "]"}], " ", 
          RowBox[{"s2", "[", "t", "]"}]}], 
         RowBox[{"1", "+", 
          SuperscriptBox[
           RowBox[{"s1", "[", "t", "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"s2", "[", "t", "]"}], "2"]}]]}], "-", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "+", 
           SuperscriptBox[
            RowBox[{"s1", "[", "t", "]"}], "2"], "-", 
           SuperscriptBox[
            RowBox[{"s2", "[", "t", "]"}], "2"]}], ")"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Psi]", "[", "t", "]"}], "]"}]}], 
        RowBox[{"1", "+", 
         SuperscriptBox[
          RowBox[{"s1", "[", "t", "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"s2", "[", "t", "]"}], "2"]}]]}], 
      RowBox[{
       FractionBox[
        RowBox[{"2", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"\[Psi]", "[", "t", "]"}], "]"}], " ", 
         RowBox[{"s1", "[", "t", "]"}]}], 
        RowBox[{"1", "+", 
         SuperscriptBox[
          RowBox[{"s1", "[", "t", "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"s2", "[", "t", "]"}], "2"]}]], "-", 
       FractionBox[
        RowBox[{"2", " ", 
         RowBox[{"s2", "[", "t", "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Psi]", "[", "t", "]"}], "]"}]}], 
        RowBox[{"1", "+", 
         SuperscriptBox[
          RowBox[{"s1", "[", "t", "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"s2", "[", "t", "]"}], "2"]}]]}]},
     {
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"2", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Psi]", "[", "t", "]"}], "]"}], " ", 
          RowBox[{"s1", "[", "t", "]"}], " ", 
          RowBox[{"s2", "[", "t", "]"}]}], 
         RowBox[{"1", "+", 
          SuperscriptBox[
           RowBox[{"s1", "[", "t", "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"s2", "[", "t", "]"}], "2"]}]]}], "+", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           SuperscriptBox[
            RowBox[{"s1", "[", "t", "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"s2", "[", "t", "]"}], "2"]}], ")"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Psi]", "[", "t", "]"}], "]"}]}], 
        RowBox[{"1", "+", 
         SuperscriptBox[
          RowBox[{"s1", "[", "t", "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"s2", "[", "t", "]"}], "2"]}]]}], 
      RowBox[{
       FractionBox[
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Psi]", "[", "t", "]"}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           SuperscriptBox[
            RowBox[{"s1", "[", "t", "]"}], "2"], "-", 
           SuperscriptBox[
            RowBox[{"s2", "[", "t", "]"}], "2"]}], ")"}]}], 
        RowBox[{"1", "+", 
         SuperscriptBox[
          RowBox[{"s1", "[", "t", "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"s2", "[", "t", "]"}], "2"]}]], "-", 
       FractionBox[
        RowBox[{"2", " ", 
         RowBox[{"s1", "[", "t", "]"}], " ", 
         RowBox[{"s2", "[", "t", "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Psi]", "[", "t", "]"}], "]"}]}], 
        RowBox[{"1", "+", 
         SuperscriptBox[
          RowBox[{"s1", "[", "t", "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"s2", "[", "t", "]"}], "2"]}]]}], 
      RowBox[{
       FractionBox[
        RowBox[{"2", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"\[Psi]", "[", "t", "]"}], "]"}], " ", 
         RowBox[{"s2", "[", "t", "]"}]}], 
        RowBox[{"1", "+", 
         SuperscriptBox[
          RowBox[{"s1", "[", "t", "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"s2", "[", "t", "]"}], "2"]}]], "+", 
       FractionBox[
        RowBox[{"2", " ", 
         RowBox[{"s1", "[", "t", "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Psi]", "[", "t", "]"}], "]"}]}], 
        RowBox[{"1", "+", 
         SuperscriptBox[
          RowBox[{"s1", "[", "t", "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"s2", "[", "t", "]"}], "2"]}]]}]},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", 
         RowBox[{"s1", "[", "t", "]"}]}], 
        RowBox[{"1", "+", 
         SuperscriptBox[
          RowBox[{"s1", "[", "t", "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"s2", "[", "t", "]"}], "2"]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", 
         RowBox[{"s2", "[", "t", "]"}]}], 
        RowBox[{"1", "+", 
         SuperscriptBox[
          RowBox[{"s1", "[", "t", "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"s2", "[", "t", "]"}], "2"]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         SuperscriptBox[
          RowBox[{"s1", "[", "t", "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"s2", "[", "t", "]"}], "2"]}], 
        RowBox[{"1", "+", 
         SuperscriptBox[
          RowBox[{"s1", "[", "t", "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"s2", "[", "t", "]"}], "2"]}]]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.751114068844186*^9, 3.751114074470681*^9}, 
   3.751114111045108*^9, {3.751114182446561*^9, 3.751114192740321*^9}, 
   3.751114245554929*^9, {3.75111496643482*^9, 3.751115002066638*^9}, {
   3.751115050015197*^9, 3.751115060335045*^9}, {3.7511151249945374`*^9, 
   3.751115212614797*^9}, 3.751115261389495*^9, 3.751115371902375*^9, 
   3.751115688520506*^9, 3.751115724677617*^9, {3.7511164849192553`*^9, 
   3.751116513825913*^9}, {3.7511175476897583`*^9, 3.7511175801474257`*^9}, 
   3.751550017950387*^9, 3.751550085400359*^9, {3.7515501334122562`*^9, 
   3.751550138998926*^9}, {3.751550218941135*^9, 3.7515502385780287`*^9}, 
   3.7515502742127666`*^9, {3.751550318144128*^9, 3.751550341881589*^9}, 
   3.751550428770467*^9, 3.751550531651454*^9, {3.751551757834095*^9, 
   3.751551778935154*^9}, 3.751551823800394*^9, {3.751551857387322*^9, 
   3.751551877298506*^9}, 3.7515519303543873`*^9, {3.7515520012059593`*^9, 
   3.751552022263667*^9}, 3.751552057894987*^9, {3.751552163301697*^9, 
   3.7515522156138887`*^9}, 3.751552247620131*^9, 3.751553566747217*^9, 
   3.856979996819071*^9, 3.856980034438096*^9, 3.8569800702664423`*^9, 
   3.856980115874977*^9},
 CellLabel->
  "Out[10]//MatrixForm=",ExpressionUUID->"1d9b60c9-2722-47c1-92cd-\
7ffba75c299b"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["System Modeling ", "Section",
 CellChangeTimes->{{3.7511138259200907`*^9, 3.751113829552498*^9}, {
  3.751114011425928*^9, 3.75111402228336*^9}, {3.751114827393429*^9, 
  3.751114827655126*^9}},ExpressionUUID->"7e440c57-b826-43a1-b274-\
70858315908b"],

Cell["\<\
This section introduces the nonlinear dynamic model and observation model\
\>", "Text",
 CellChangeTimes->{{3.751114026835989*^9, 3.751114040654141*^9}, {
   3.7511140933828506`*^9, 3.751114094710662*^9}, 
   3.751115498254581*^9},ExpressionUUID->"1c058ca5-fbe4-40ff-8c9a-\
734503dfe586"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"v", "=", 
    RowBox[{"{", 
     RowBox[{"v1", ",", "v2", ",", "v3"}], "}"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"velocity", " ", "vector", " ", "in", " ", "body"}], "-", 
    RowBox[{"fixed", " ", "frame"}]}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.7263334941805468`*^9, 3.726333501805942*^9}, {
  3.7263405292176228`*^9, 3.726340537821747*^9}, {3.726340664299487*^9, 
  3.726340673018428*^9}, {3.744910816254117*^9, 3.744910822063188*^9}, {
  3.7451625211195593`*^9, 3.745162521122746*^9}, {3.7511136519994307`*^9, 
  3.751113657576942*^9}, {3.7511138084664793`*^9, 3.75111382122276*^9}, {
  3.751114198553936*^9, 3.751114204492853*^9}, {3.751114236679497*^9, 
  3.7511142417558937`*^9}, {3.751114530873941*^9, 3.751114535228519*^9}, {
  3.751115171308735*^9, 3.751115196238652*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"f6115044-be6b-46a3-a9b3-ab977a9e477a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Omega]hat", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"-", "\[Omega]3"}], ",", "\[Omega]2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Omega]3", ",", "0", ",", 
        RowBox[{"-", "\[Omega]1"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "\[Omega]2"}], ",", "\[Omega]1", ",", "0"}], "}"}]}], 
     "}"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"skew", "-", 
    RowBox[{"symmetric", " ", "body"}], "-", 
    RowBox[{"frame", " ", "angular", " ", "velocity", " ", "matrix"}]}], " ", 
   "*)"}]}]], "Input",
 CellLabel->"In[12]:=",ExpressionUUID->"ee6a28fc-c56d-4b92-b8a5-4b0bde487982"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"rules", "=", 
  RowBox[{
   RowBox[{"Simplify", "[", 
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{"r", ",", "t"}], "]"}], "\[Equal]", 
       RowBox[{"r", ".", "\[Omega]hat"}]}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"s1", "[", "t", "]"}], ",", "t"}], "]"}], ",", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"s2", "[", "t", "]"}], ",", "t"}], "]"}], ",", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"\[Psi]", "[", "t", "]"}], ",", "t"}], "]"}]}], "}"}]}], 
     "]"}], "]"}], " ", "[", 
   RowBox[{"[", "1", "]"}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{"rotational", " ", "kinematics"}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.7515499602560368`*^9, 3.751550052598084*^9}, {
  3.751550126419127*^9, 3.7515501305081797`*^9}, {3.751550209195814*^9, 
  3.751550271334059*^9}, {3.751552048435905*^9, 3.751552053799458*^9}, {
  3.7515521101038847`*^9, 3.751552110633917*^9}, {3.7515522440924473`*^9, 
  3.751552244648061*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"de24fdd9-a7eb-4cb0-bc6d-91d01f670942"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     SuperscriptBox["s1", "\[Prime]",
      MultilineFunction->None], "[", "t", "]"}], "\[Rule]", 
    RowBox[{
     FractionBox["1", "2"], " ", 
     RowBox[{"(", 
      RowBox[{"\[Omega]2", "+", 
       RowBox[{"\[Omega]2", " ", 
        SuperscriptBox[
         RowBox[{"s1", "[", "t", "]"}], "2"]}], "+", 
       RowBox[{"2", " ", "\[Omega]3", " ", 
        RowBox[{"s2", "[", "t", "]"}]}], "-", 
       RowBox[{"2", " ", "\[Omega]1", " ", 
        RowBox[{"s1", "[", "t", "]"}], " ", 
        RowBox[{"s2", "[", "t", "]"}]}], "-", 
       RowBox[{"\[Omega]2", " ", 
        SuperscriptBox[
         RowBox[{"s2", "[", "t", "]"}], "2"]}]}], ")"}]}]}], ",", 
   RowBox[{
    RowBox[{
     SuperscriptBox["s2", "\[Prime]",
      MultilineFunction->None], "[", "t", "]"}], "\[Rule]", 
    RowBox[{
     FractionBox["1", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[Omega]1", " ", 
        SuperscriptBox[
         RowBox[{"s1", "[", "t", "]"}], "2"]}], "-", 
       RowBox[{"2", " ", 
        RowBox[{"s1", "[", "t", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{"\[Omega]3", "-", 
          RowBox[{"\[Omega]2", " ", 
           RowBox[{"s2", "[", "t", "]"}]}]}], ")"}]}], "-", 
       RowBox[{"\[Omega]1", " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox[
           RowBox[{"s2", "[", "t", "]"}], "2"]}], ")"}]}]}], ")"}]}]}], ",", 
   RowBox[{
    RowBox[{
     SuperscriptBox["\[Psi]", "\[Prime]",
      MultilineFunction->None], "[", "t", "]"}], "\[Rule]", 
    RowBox[{"\[Omega]3", "-", 
     RowBox[{"\[Omega]1", " ", 
      RowBox[{"s1", "[", "t", "]"}]}], "-", 
     RowBox[{"\[Omega]2", " ", 
      RowBox[{"s2", "[", "t", "]"}]}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.751552163741288*^9, 3.751552216157167*^9}, 
   3.7515522480092983`*^9, 3.7515535671292887`*^9, 3.856979997393651*^9, 
   3.856980034934716*^9, 3.856980070832499*^9, 3.856980116394227*^9},
 CellLabel->"Out[13]=",ExpressionUUID->"e63e0fda-636e-47df-aa31-6e24920b6033"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"state", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"s1", "[", "t", "]"}], ",", 
      RowBox[{"s2", "[", "t", "]"}], ",", "v1", ",", "v2", ",", "v3", ",", 
      "b1", ",", "b2", ",", "b3", ",", "kf", ",", "kd", ",", "kz"}], "}"}]}], 
   ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"state", " ", "vector"}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.7263190408645153`*^9, 3.72631910836049*^9}, 
   3.726320145116308*^9, {3.726340677568771*^9, 3.726340716304493*^9}, {
   3.7263432231131363`*^9, 3.726343224627439*^9}, {3.726343517302115*^9, 
   3.726343517585971*^9}, {3.7263435505944853`*^9, 3.726343550768342*^9}, {
   3.726350155042644*^9, 3.726350155519866*^9}, {3.726420569006031*^9, 
   3.7264205719593067`*^9}, {3.7274808746143627`*^9, 
   3.7274808749474697`*^9}, {3.727529556618785*^9, 3.727529557109819*^9}, {
   3.744904736186284*^9, 3.744904759286422*^9}, {3.74491068856404*^9, 
   3.744910702401293*^9}, {3.744912962622048*^9, 3.744912963103321*^9}, {
   3.744913070814433*^9, 3.744913071265979*^9}, {3.744914293557662*^9, 
   3.7449142941668367`*^9}, {3.745162521020299*^9, 3.7451625210293417`*^9}, {
   3.751113030975597*^9, 3.751113038332192*^9}, {3.751113072812146*^9, 
   3.751113074639555*^9}, {3.751113233603983*^9, 3.751113261942855*^9}, {
   3.751113297064599*^9, 3.7511133249485283`*^9}, {3.7511133770838614`*^9, 
   3.751113384019566*^9}, {3.751114208414093*^9, 3.7511142339179296`*^9}, {
   3.7511151779621162`*^9, 3.751115194313491*^9}, 3.751550527889163*^9, {
   3.7515521512451067`*^9, 3.7515521531455517`*^9}, {3.75155349239047*^9, 
   3.751553534582052*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"3fdd5045-45c0-4679-89af-fbc071261350"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"a", "=", 
    RowBox[{
     RowBox[{"kf", "*", "uss", "*", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "-", 
     RowBox[{"us", "*", 
      RowBox[{
       RowBox[{"DiagonalMatrix", "[", 
        RowBox[{"{", 
         RowBox[{"kd", ",", "kd", ",", "kz"}], "}"}], "]"}], ".", "v"}]}], 
     " ", "-", 
     RowBox[{"g", "*", 
      RowBox[{"r", "[", 
       RowBox[{"[", 
        RowBox[{"3", ",", ";;"}], "]"}], "]"}]}]}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"acceleration", " ", "in", " ", "body"}], "-", 
    RowBox[{"fixed", " ", "frame"}]}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.726333456667694*^9, 3.726333516287778*^9}, {
   3.7263335781933403`*^9, 3.7263335989136972`*^9}, {3.726334061388433*^9, 
   3.726334116750856*^9}, {3.726334161422242*^9, 3.726334162988543*^9}, {
   3.7263342131916656`*^9, 3.726334213286091*^9}, 3.726334363602138*^9, 
   3.726335341215971*^9, {3.7263366779487886`*^9, 3.726336678421893*^9}, 
   3.726338342596532*^9, {3.726339121830298*^9, 3.7263391416670856`*^9}, {
   3.726340507348166*^9, 3.72634056081291*^9}, {3.726340781463262*^9, 
   3.726340806122808*^9}, {3.726343573382071*^9, 3.726343593591531*^9}, {
   3.7274809085657053`*^9, 3.727480936277856*^9}, {3.7274811321920443`*^9, 
   3.72748113793338*^9}, {3.7275281199543953`*^9, 3.7275281282292833`*^9}, {
   3.727529725553892*^9, 3.7275297397594976`*^9}, {3.7278030544559393`*^9, 
   3.727803062621028*^9}, 3.7278031693989477`*^9, 3.744907520313343*^9, {
   3.744910827919962*^9, 3.744910833906193*^9}, {3.74516252113444*^9, 
   3.7451625417554197`*^9}, {3.751114295265847*^9, 3.7511143143189583`*^9}, {
   3.7511144393345947`*^9, 3.751114605264613*^9}, 3.751115046917375*^9, {
   3.751115122602543*^9, 3.7511151895305347`*^9}, 3.751115256574214*^9, {
   3.7511179208532887`*^9, 3.751117931515136*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"1ceb89bc-7a9e-4369-9571-a93da7c6ebba"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"vdot", "=", 
    RowBox[{"a", "-", 
     RowBox[{"Cross", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Omega]1", ",", "\[Omega]2", ",", "\[Omega]3"}], "}"}], ",",
        "v"}], "]"}]}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"derivative", " ", "of", " ", "v"}], ",", " ", 
    RowBox[{"with", " ", "Coriolis", " ", "term"}]}], " ", "*)"}]}]], "Input",\

 CellChangeTimes->{{3.751114607956161*^9, 3.7511146232442627`*^9}, {
  3.751115718220255*^9, 3.7511157212351103`*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"02799d5f-b064-45a4-9b7f-90950d7d501a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"sdot", "=", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"s1", "'"}], "[", "t", "]"}], ",", 
       RowBox[{
        RowBox[{"s2", "'"}], "[", "t", "]"}]}], "}"}], "/.", "rules"}]}], 
   ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "derivatives", " ", "of", " ", "stereographic", " ", "coordinates"}], " ", 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.726337235967815*^9, 3.7263372649149027`*^9}, 
   3.726338337815008*^9, {3.726340813598626*^9, 3.7263408163953257`*^9}, {
   3.744909478343732*^9, 3.7449095656322403`*^9}, {3.744910845304344*^9, 
   3.744910864551059*^9}, {3.745162521223135*^9, 3.745162521233376*^9}, {
   3.751114645147252*^9, 3.7511146679700203`*^9}, {3.751115264766136*^9, 
   3.751115274915432*^9}, {3.751550303797654*^9, 3.751550336400388*^9}, {
   3.751550386139887*^9, 3.751550425070804*^9}, 3.751550463405196*^9, {
   3.751552015659096*^9, 3.751552019080305*^9}},
 CellLabel->"In[17]:=",ExpressionUUID->"9bd2d820-fd0e-462d-841a-c04bc9be8e76"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"f", "=", 
    RowBox[{"Simplify", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"sdot", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"sdot", "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", 
       RowBox[{"vdot", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"vdot", "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", 
       RowBox[{"vdot", "[", 
        RowBox[{"[", "3", "]"}], "]"}], ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "0"}], "}"}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"vector", " ", "field", " ", "of", " ", "system"}], " ", 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.7263371620172663`*^9, 3.726337224727683*^9}, {
   3.726337326839097*^9, 3.72633732962768*^9}, 3.726338159969159*^9, 
   3.726338330196361*^9, {3.7263408307896967`*^9, 3.72634086832269*^9}, {
   3.726343232619191*^9, 3.726343232838537*^9}, {3.7263435255104227`*^9, 
   3.726343553576786*^9}, {3.726350179189693*^9, 3.726350179609819*^9}, {
   3.7264205902586718`*^9, 3.726420590478036*^9}, {3.72748004375185*^9, 
   3.727480055892549*^9}, {3.727480179463242*^9, 3.7274802021799088`*^9}, {
   3.727480233638103*^9, 3.727480286668562*^9}, {3.727480359276862*^9, 
   3.727480376561717*^9}, {3.7274809603024387`*^9, 3.727480969758607*^9}, {
   3.727528144938493*^9, 3.7275281561128807`*^9}, {3.7275293703516073`*^9, 
   3.7275293753401537`*^9}, 3.72752943645461*^9, {3.727529565530403*^9, 
   3.727529565748837*^9}, {3.7275297641715097`*^9, 3.727529764699033*^9}, {
   3.7278031906115847`*^9, 3.727803208413724*^9}, {3.744912394162809*^9, 
   3.744912398995322*^9}, {3.744912478969747*^9, 3.74491248026236*^9}, {
   3.744912533461483*^9, 3.744912547997954*^9}, {3.744912694622016*^9, 
   3.7449126970422993`*^9}, {3.7449130393271437`*^9, 3.744913048957687*^9}, {
   3.744913331575098*^9, 3.744913333341708*^9}, {3.744913505634885*^9, 
   3.744913651029483*^9}, {3.7449137015699*^9, 3.744913724194963*^9}, {
   3.744914326892017*^9, 3.744914351876979*^9}, {3.74514300740462*^9, 
   3.745143020170549*^9}, {3.751114779518557*^9, 3.75111479132876*^9}, 
   3.751114998452322*^9, {3.751115354319366*^9, 3.751115367142716*^9}, 
   3.751551854360298*^9, {3.75155353972777*^9, 3.751553542467225*^9}},
 CellLabel->"In[18]:=",ExpressionUUID->"dbbc97cc-84ad-4746-ade2-82e0da74c972"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"f0", "=", 
  RowBox[{"f", "/.", 
   RowBox[{"{", 
    RowBox[{"uss", "\[Rule]", "0"}], "}"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{"unforced", " ", "vector", " ", "field"}], " ", 
    "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.7451430373136387`*^9, 3.745143050485455*^9}, {
   3.7451430862064133`*^9, 3.745143088808381*^9}, {3.745143207892481*^9, 
   3.74514320879939*^9}, 3.745162554257217*^9, {3.751114892180132*^9, 
   3.751114892350172*^9}, 3.7511149871180964`*^9, {3.751115374780805*^9, 
   3.7511153888836*^9}, 3.751117380491794*^9, {3.751553550016922*^9, 
   3.751553555745385*^9}},
 CellLabel->"In[19]:=",ExpressionUUID->"33025bef-b023-4c0b-86cd-f939497a4d28"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{"(", 
     RowBox[{"\[Omega]2", "+", 
      RowBox[{"\[Omega]2", " ", 
       SuperscriptBox[
        RowBox[{"s1", "[", "t", "]"}], "2"]}], "+", 
      RowBox[{"2", " ", "\[Omega]3", " ", 
       RowBox[{"s2", "[", "t", "]"}]}], "-", 
      RowBox[{"2", " ", "\[Omega]1", " ", 
       RowBox[{"s1", "[", "t", "]"}], " ", 
       RowBox[{"s2", "[", "t", "]"}]}], "-", 
      RowBox[{"\[Omega]2", " ", 
       SuperscriptBox[
        RowBox[{"s2", "[", "t", "]"}], "2"]}]}], ")"}]}], ",", 
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"\[Omega]1", " ", 
       SuperscriptBox[
        RowBox[{"s1", "[", "t", "]"}], "2"]}], "-", 
      RowBox[{"2", " ", 
       RowBox[{"s1", "[", "t", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{"\[Omega]3", "-", 
         RowBox[{"\[Omega]2", " ", 
          RowBox[{"s2", "[", "t", "]"}]}]}], ")"}]}], "-", 
      RowBox[{"\[Omega]1", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         SuperscriptBox[
          RowBox[{"s2", "[", "t", "]"}], "2"]}], ")"}]}]}], ")"}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "kd"}], " ", "us", " ", "v1"}], "-", 
    RowBox[{"v3", " ", "\[Omega]2"}], "+", 
    RowBox[{"v2", " ", "\[Omega]3"}], "+", 
    FractionBox[
     RowBox[{"2", " ", "g", " ", 
      RowBox[{"s1", "[", "t", "]"}]}], 
     RowBox[{"1", "+", 
      SuperscriptBox[
       RowBox[{"s1", "[", "t", "]"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"s2", "[", "t", "]"}], "2"]}]]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "kd"}], " ", "us", " ", "v2"}], "+", 
    RowBox[{"v3", " ", "\[Omega]1"}], "-", 
    RowBox[{"v1", " ", "\[Omega]3"}], "+", 
    FractionBox[
     RowBox[{"2", " ", "g", " ", 
      RowBox[{"s2", "[", "t", "]"}]}], 
     RowBox[{"1", "+", 
      SuperscriptBox[
       RowBox[{"s1", "[", "t", "]"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"s2", "[", "t", "]"}], "2"]}]]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "kz"}], " ", "us", " ", "v3"}], "-", 
    RowBox[{"v2", " ", "\[Omega]1"}], "+", 
    RowBox[{"v1", " ", "\[Omega]2"}], "+", 
    FractionBox[
     RowBox[{"g", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        SuperscriptBox[
         RowBox[{"s1", "[", "t", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"s2", "[", "t", "]"}], "2"]}], ")"}]}], 
     RowBox[{"1", "+", 
      SuperscriptBox[
       RowBox[{"s1", "[", "t", "]"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"s2", "[", "t", "]"}], "2"]}]]}], ",", "0", ",", "0", ",", "0",
    ",", "0", ",", "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.751114991420925*^9, 3.75111500226376*^9}, {
   3.751115050207182*^9, 3.751115060528964*^9}, {3.751115125172647*^9, 
   3.751115212824757*^9}, 3.7511152616057262`*^9, 3.751115372077546*^9, 
   3.751115688654374*^9, 3.7511157248120823`*^9, {3.7511164850564127`*^9, 
   3.751116513916098*^9}, {3.7511175477738457`*^9, 3.751117580216123*^9}, 
   3.75155001812157*^9, 3.751550085799205*^9, {3.7515501341459427`*^9, 
   3.751550139157411*^9}, {3.751550220254212*^9, 3.7515502390573797`*^9}, 
   3.751550274384906*^9, {3.751550318301914*^9, 3.7515503420539427`*^9}, 
   3.751550428934373*^9, 3.751550531886297*^9, {3.751551758073382*^9, 
   3.751551779439633*^9}, 3.7515518248231573`*^9, {3.751551858012908*^9, 
   3.751551877939994*^9}, 3.75155193091838*^9, {3.751552001591983*^9, 
   3.751552022636402*^9}, 3.751552058192503*^9, {3.7515521639251204`*^9, 
   3.751552216362792*^9}, 3.751552248168786*^9, 3.751553567273546*^9, 
   3.856979997549047*^9, 3.856980035052084*^9, 3.856980070908166*^9, 
   3.856980116531652*^9},
 CellLabel->"Out[19]=",ExpressionUUID->"92ee3503-bb2b-47ad-ac1e-3875c2e35965"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"f1", "=", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"f", "-", "f0"}], ")"}], "/.", 
    RowBox[{"{", 
     RowBox[{"uss", "\[Rule]", "1"}], "}"}]}], "]"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"input", " ", "vector", " ", "field"}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.745143128796064*^9, 3.745143161395455*^9}, {
   3.745143304014414*^9, 3.745143309553441*^9}, {3.745143356451292*^9, 
   3.745143364283338*^9}, 3.745162563302719*^9, {3.751114900077364*^9, 
   3.7511149622854633`*^9}, {3.751115208857535*^9, 3.751115209020681*^9}, {
   3.751115381015677*^9, 3.7511153861305857`*^9}, 3.7511156612839193`*^9, {
   3.751117383868181*^9, 3.751117388266799*^9}},
 CellLabel->"In[20]:=",ExpressionUUID->"45a79a51-2bc4-4858-8447-4567ae1c43e7"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "0", ",", "0", ",", "0", ",", "kf", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.7511149665846987`*^9, 3.7511150023121347`*^9}, {
   3.7511150502496567`*^9, 3.75111506057742*^9}, {3.75111512521959*^9, 
   3.751115212832439*^9}, 3.751115261655284*^9, 3.751115372135765*^9, 
   3.751115688695155*^9, 3.751115724818727*^9, {3.751116485103621*^9, 
   3.751116513955241*^9}, {3.7511175478114*^9, 3.7511175802430973`*^9}, 
   3.751550018162529*^9, 3.7515500858318253`*^9, {3.7515501341817083`*^9, 
   3.751550139193486*^9}, {3.751550220294771*^9, 3.751550239096987*^9}, 
   3.7515502744261303`*^9, {3.751550318342786*^9, 3.7515503420925922`*^9}, 
   3.751550428974052*^9, 3.751550531926076*^9, {3.751551758121867*^9, 
   3.75155177947056*^9}, 3.751551824844397*^9, {3.751551858054388*^9, 
   3.751551877983849*^9}, 3.751551930958959*^9, {3.751552001639172*^9, 
   3.751552022679617*^9}, 3.751552058230831*^9, {3.751552163971899*^9, 
   3.751552216697275*^9}, 3.751552248205524*^9, 3.751553567315913*^9, 
   3.8569799975752277`*^9, 3.8569800350728083`*^9, 3.856980070932824*^9, 
   3.856980116559186*^9},
 CellLabel->"Out[20]=",ExpressionUUID->"bffd52c7-94ae-436a-8ca1-a9d2e88b0701"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"h", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"-", "kd"}], " ", "*", "us", "*", "v1"}], "+", "b1"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "kd"}], "*", "us", "*", " ", "v2"}], "+", "b2"}], ",", 
     RowBox[{
      RowBox[{"kf", "*", "uss"}], "-", 
      RowBox[{"kz", "*", "u3", "*", "v3"}], "+", "b3"}]}], "}"}]}], ";", " ", 
  
  RowBox[{"(*", " ", 
   RowBox[{"measurement", " ", "model"}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.751115557641556*^9, 3.751115624392685*^9}, {
  3.751115662799329*^9, 3.751115663672744*^9}, {3.856979983668734*^9, 
  3.856979987942237*^9}},
 CellLabel->"In[21]:=",ExpressionUUID->"fc5a9085-3e98-47d1-a398-4da5a1ad1f22"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Observability Analysis ", "Section",
 CellChangeTimes->{{3.751115405435524*^9, 3.751115409367957*^9}, 
   3.751115474906275*^9},ExpressionUUID->"554272a7-2b52-4f82-bd29-\
47b34a6747f6"],

Cell["This section demonstrates the observability analysis", "Text",
 CellChangeTimes->{{3.7511155264819527`*^9, 
  3.7511155496773148`*^9}},ExpressionUUID->"6149a945-d25b-4471-98ef-\
2c87f09744cf"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"L", "=", "h"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"zeroth", "-", 
    RowBox[{"order", " ", "Lie", " ", "derivative"}]}], " ", 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.726340123903077*^9, 3.726340191389882*^9}, {
  3.751115639985997*^9, 3.751115671035219*^9}},
 CellLabel->"In[22]:=",ExpressionUUID->"e4cf1648-9e94-4281-bdef-470eeb9e2687"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Lf0", "=", 
  RowBox[{"Dot", "[", 
   RowBox[{
    RowBox[{"Grad", "[", 
     RowBox[{"L", ",", "state"}], "]"}], ",", "f0"}], "]"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"first", "-", 
    RowBox[{"order", " ", "Lie", " ", "derivative", " ", 
     RowBox[{"w", ".", "r", ".", "t", ".", " ", "unforced"}], " ", "vector", 
     " ", "field"}]}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.726340213864965*^9, 3.726340263368842*^9}, {
   3.726340383742404*^9, 3.726340384521961*^9}, {3.7263410707489223`*^9, 
   3.726341079283804*^9}, {3.72634122564016*^9, 3.726341226720133*^9}, 
   3.727523024364004*^9, 3.727803369542491*^9, {3.744912971438513*^9, 
   3.744912971915007*^9}, {3.744913065151773*^9, 3.744913067088854*^9}, {
   3.745143548373008*^9, 3.745143549582625*^9}, {3.745159707570634*^9, 
   3.745159709392295*^9}, 3.7451614507858467`*^9, {3.751115651682974*^9, 
   3.751115684803761*^9}, {3.75111645584811*^9, 3.751116456138896*^9}, {
   3.75111740085175*^9, 3.751117407837034*^9}},
 CellLabel->"In[23]:=",ExpressionUUID->"cfc5a84c-2ad2-4718-9a06-feb75f03dff3"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"-", "kd"}], " ", "us", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "kd"}], " ", "us", " ", "v1"}], "-", 
      RowBox[{"v3", " ", "\[Omega]2"}], "+", 
      RowBox[{"v2", " ", "\[Omega]3"}], "+", 
      FractionBox[
       RowBox[{"2", " ", "g", " ", 
        RowBox[{"s1", "[", "t", "]"}]}], 
       RowBox[{"1", "+", 
        SuperscriptBox[
         RowBox[{"s1", "[", "t", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"s2", "[", "t", "]"}], "2"]}]]}], ")"}]}], ",", 
   RowBox[{
    RowBox[{"-", "kd"}], " ", "us", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "kd"}], " ", "us", " ", "v2"}], "+", 
      RowBox[{"v3", " ", "\[Omega]1"}], "-", 
      RowBox[{"v1", " ", "\[Omega]3"}], "+", 
      FractionBox[
       RowBox[{"2", " ", "g", " ", 
        RowBox[{"s2", "[", "t", "]"}]}], 
       RowBox[{"1", "+", 
        SuperscriptBox[
         RowBox[{"s1", "[", "t", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"s2", "[", "t", "]"}], "2"]}]]}], ")"}]}], ",", 
   RowBox[{
    RowBox[{"-", "kz"}], " ", "u3", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "kz"}], " ", "us", " ", "v3"}], "-", 
      RowBox[{"v2", " ", "\[Omega]1"}], "+", 
      RowBox[{"v1", " ", "\[Omega]2"}], "+", 
      FractionBox[
       RowBox[{"g", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          SuperscriptBox[
           RowBox[{"s1", "[", "t", "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"s2", "[", "t", "]"}], "2"]}], ")"}]}], 
       RowBox[{"1", "+", 
        SuperscriptBox[
         RowBox[{"s1", "[", "t", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"s2", "[", "t", "]"}], "2"]}]]}], ")"}]}]}], "}"}]], "Output",\

 CellChangeTimes->{
  3.751115688759961*^9, 3.751115724891415*^9, {3.751116485178303*^9, 
   3.751116514020413*^9}, {3.751117547871345*^9, 3.751117580281766*^9}, 
   3.7515500182196074`*^9, 3.751550085870307*^9, {3.751550134226962*^9, 
   3.751550139237076*^9}, {3.7515502203435173`*^9, 3.751550239141848*^9}, 
   3.751550274482656*^9, {3.751550318392807*^9, 3.751550342135816*^9}, 
   3.751550429033867*^9, 3.751550531981896*^9, {3.751551758173696*^9, 
   3.751551779515581*^9}, 3.7515518248742523`*^9, {3.7515518581159782`*^9, 
   3.751551878492951*^9}, 3.751551931023616*^9, {3.751552001704236*^9, 
   3.751552022761286*^9}, 3.7515520582966547`*^9, {3.751552164056143*^9, 
   3.751552216885147*^9}, 3.751552248259371*^9, 3.7515535673802023`*^9, 
   3.8569799976246643`*^9, 3.856980070975233*^9, 3.85698011664666*^9},
 CellLabel->"Out[23]=",ExpressionUUID->"4447013f-a8f1-4b49-8228-2dfd92fe4708"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Lf1", "=", 
  RowBox[{"Dot", "[", 
   RowBox[{
    RowBox[{"Grad", "[", 
     RowBox[{"L", ",", "state"}], "]"}], ",", "f1"}], "]"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"first", "-", 
    RowBox[{"order", " ", "Lie", " ", "derivative", " ", 
     RowBox[{"w", ".", "r", ".", "t", ".", " ", "input"}], " ", "vector", " ",
      "field"}]}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.726341322945765*^9, 3.72634134428612*^9}, {
   3.727481386473184*^9, 3.727481402679552*^9}, 3.745161453945072*^9, {
   3.751116389889894*^9, 3.7511164813717747`*^9}, {3.751117410405757*^9, 
   3.751117413255206*^9}},
 CellLabel->"In[24]:=",ExpressionUUID->"cb369cce-5d00-46ef-810e-f13d32684c65"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", 
   RowBox[{
    RowBox[{"-", "kf"}], " ", "kz", " ", "u3"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.751116485232589*^9, 3.751116514065798*^9}, {
   3.751117547913493*^9, 3.751117580313258*^9}, 3.751550018264585*^9, 
   3.751550085905932*^9, {3.751550134264559*^9, 3.7515501392724743`*^9}, {
   3.7515502203851843`*^9, 3.751550239182905*^9}, 3.751550274524577*^9, {
   3.751550318431491*^9, 3.751550342173052*^9}, 3.751550429072653*^9, 
   3.751550532018482*^9, {3.751551758215205*^9, 3.75155177954814*^9}, 
   3.751551824896954*^9, {3.7515518581598797`*^9, 3.7515518785361032`*^9}, 
   3.751551931070944*^9, {3.751552001756783*^9, 3.7515520228149633`*^9}, 
   3.751552058342613*^9, {3.751552164109497*^9, 3.751552216937512*^9}, 
   3.751552248270021*^9, 3.7515535674193487`*^9, 3.856979997655126*^9, 
   3.856980071001884*^9, 3.856980116670987*^9},
 CellLabel->"Out[24]=",ExpressionUUID->"49e79790-1032-4952-b119-8c556790d25a"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Lf0f0", "=", 
    RowBox[{"Simplify", "[", 
     RowBox[{"Dot", "[", 
      RowBox[{
       RowBox[{"Grad", "[", 
        RowBox[{"Lf0", ",", "state"}], "]"}], ",", "f0"}], "]"}], "]"}]}], 
   ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"second", "-", 
    RowBox[{"order", " ", "Lie", " ", "derivative", " ", 
     RowBox[{"w", ".", "r", ".", "t", ".", " ", "unforced"}], " ", "vector", 
     " ", "field"}]}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.7274805308188877`*^9, 3.727480550981412*^9}, {
   3.7274806765089817`*^9, 3.7274806856049843`*^9}, 3.727523052372294*^9, 
   3.744914205355569*^9, {3.745143542731015*^9, 3.745143543850335*^9}, {
   3.745143590351186*^9, 3.745143591962535*^9}, 3.745159788140229*^9, {
   3.745161456228014*^9, 3.745161461745283*^9}, {3.751116433561105*^9, 
   3.751116448846878*^9}, {3.751116489697956*^9, 3.75111651012742*^9}, {
   3.7511174167316723`*^9, 3.751117426139061*^9}},
 CellLabel->"In[25]:=",ExpressionUUID->"a08bdb2a-cb2e-4568-b716-d7060da2c723"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Lf0f1", "=", 
    RowBox[{"Dot", "[", 
     RowBox[{
      RowBox[{"Grad", "[", 
       RowBox[{"Lf0", ",", "state"}], "]"}], ",", "f1"}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"second", "-", 
    RowBox[{"order", " ", "Lie", " ", "derivative", " ", 
     RowBox[{"w", ".", "r", ".", "t", ".", " ", "unforced"}], " ", "and", " ",
      "forced", " ", "vector", " ", "fields"}]}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.727482619831847*^9, 3.72748267337027*^9}, {
   3.727482797422736*^9, 3.727482801028126*^9}, {3.727482845191534*^9, 
   3.727482846662242*^9}, 3.745162378106641*^9, {3.751116475666935*^9, 
   3.751116493379983*^9}, {3.751117429408537*^9, 3.751117463426298*^9}},
 CellLabel->"In[26]:=",ExpressionUUID->"8d7bf188-19ce-437e-aeab-b569f0c532c2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"lies", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"L", ",", "Lf0", ",", "Lf1", ",", "Lf0f0", ",", "Lf0f1"}], 
    "]"}]}], ";", " ", 
  RowBox[{"(*", " ", 
   RowBox[{"stacking", " ", "the", " ", "lie", " ", "derivatives"}], " ", 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.726341403917178*^9, 3.726341408664077*^9}, {
   3.7263415613412857`*^9, 3.726341581629651*^9}, {3.7263416151390944`*^9, 
   3.726341641132646*^9}, {3.726341716795266*^9, 3.726341717112048*^9}, {
   3.726341980794909*^9, 3.726341981404499*^9}, {3.726342211183482*^9, 
   3.7263422120149403`*^9}, {3.7266639383824167`*^9, 3.726663939000539*^9}, {
   3.727480454229239*^9, 3.727480457396991*^9}, {3.72748060336051*^9, 
   3.727480608158934*^9}, {3.727483025708902*^9, 3.7274830290899887`*^9}, 
   3.727523044878066*^9, {3.72752315388104*^9, 3.727523154733471*^9}, {
   3.7275232572270527`*^9, 3.727523260147447*^9}, {3.727523464270266*^9, 
   3.727523469802888*^9}, {3.727523691967677*^9, 3.727523698349361*^9}, {
   3.744913123795533*^9, 3.744913123991276*^9}, {3.74491384826647*^9, 
   3.7449138627214518`*^9}, {3.744914238315843*^9, 3.744914241965873*^9}, {
   3.744914426857362*^9, 3.744914427787621*^9}, {3.744914554877863*^9, 
   3.744914558047833*^9}, {3.7449146213708572`*^9, 3.7449146268980913`*^9}, {
   3.744915240797838*^9, 3.7449152432278852`*^9}, {3.751117498146369*^9, 
   3.751117515322948*^9}, {3.751117656080714*^9, 3.7511176844201393`*^9}, {
   3.856980027472229*^9, 3.8569800289113703`*^9}, 3.856980062168828*^9, {
   3.856980106501437*^9, 3.856980109295084*^9}},
 CellLabel->"In[27]:=",ExpressionUUID->"4a600330-f3dd-498a-be72-d333c236285d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"lies", "=", 
    RowBox[{"DeleteCases", "[", 
     RowBox[{"lies", ",", "0", ",", "Infinity"}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "removing", " ", "the", " ", "all", " ", "zero", " ", "rows", " ", "for", 
    " ", "visualization", " ", "purposes"}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.726660080109112*^9, 3.7266600941198072`*^9}, 
   3.7275230400546207`*^9, {3.751117633935472*^9, 3.7511176511635933`*^9}},
 CellLabel->"In[28]:=",ExpressionUUID->"faa061a9-b6b1-4fa9-8272-70eb741883f4"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"o", "=", 
    RowBox[{"Simplify", "[", 
     RowBox[{"Grad", "[", 
      RowBox[{"lies", ",", "state"}], "]"}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Computing", " ", "the", " ", "observability", " ", "matrix", " ", "by", 
    " ", "taking", " ", "the", " ", "gradient", " ", "of", " ", "the", " ", 
    "stacked", " ", "Lie", " ", "derivatives"}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.726341650993819*^9, 3.7263416677019873`*^9}, {
   3.727480659856393*^9, 3.727480664222814*^9}, 3.727523035526582*^9, 
   3.7451722365121927`*^9, 3.745173032195653*^9, {3.751117533618292*^9, 
   3.7511175542187757`*^9}, {3.751117622310672*^9, 3.7511176280151377`*^9}, {
   3.751117694540831*^9, 3.751117707558848*^9}},
 CellLabel->"In[29]:=",ExpressionUUID->"3b8d99c4-b886-4b73-bf59-2f5b42f37590"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "[", "o", "]"}]], "Input",
 CellChangeTimes->{{3.751117557423101*^9, 3.751117559666058*^9}},
 CellLabel->"In[30]:=",ExpressionUUID->"a2ade8c6-d4e7-4b3e-a7c4-4dc427e180e8"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", 
      RowBox[{
       RowBox[{"-", "kd"}], " ", "us"}], "0", "0", "1", "0", "0", "0", 
      RowBox[{
       RowBox[{"-", "us"}], " ", "v1"}], "0"},
     {"0", "0", "0", 
      RowBox[{
       RowBox[{"-", "kd"}], " ", "us"}], "0", "0", "1", "0", "0", 
      RowBox[{
       RowBox[{"-", "us"}], " ", "v2"}], "0"},
     {"0", "0", "0", "0", 
      RowBox[{
       RowBox[{"-", "kz"}], " ", "u3"}], "0", "0", "1", "uss", "0", 
      RowBox[{
       RowBox[{"-", "u3"}], " ", "v3"}]},
     {
      FractionBox[
       RowBox[{"2", " ", "g", " ", "kd", " ", "us", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          SuperscriptBox[
           RowBox[{"s1", "[", "t", "]"}], "2"], "-", 
          SuperscriptBox[
           RowBox[{"s2", "[", "t", "]"}], "2"]}], ")"}]}], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox[
           RowBox[{"s1", "[", "t", "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"s2", "[", "t", "]"}], "2"]}], ")"}], "2"]], 
      FractionBox[
       RowBox[{"4", " ", "g", " ", "kd", " ", "us", " ", 
        RowBox[{"s1", "[", "t", "]"}], " ", 
        RowBox[{"s2", "[", "t", "]"}]}], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox[
           RowBox[{"s1", "[", "t", "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"s2", "[", "t", "]"}], "2"]}], ")"}], "2"]], 
      RowBox[{
       SuperscriptBox["kd", "2"], " ", 
       SuperscriptBox["us", "2"]}], 
      RowBox[{
       RowBox[{"-", "kd"}], " ", "us", " ", "\[Omega]3"}], 
      RowBox[{"kd", " ", "us", " ", "\[Omega]2"}], "0", "0", "0", "0", 
      RowBox[{"us", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", "kd", " ", "us", " ", "v1"}], "+", 
         RowBox[{"v3", " ", "\[Omega]2"}], "-", 
         RowBox[{"v2", " ", "\[Omega]3"}], "-", 
         FractionBox[
          RowBox[{"2", " ", "g", " ", 
           RowBox[{"s1", "[", "t", "]"}]}], 
          RowBox[{"1", "+", 
           SuperscriptBox[
            RowBox[{"s1", "[", "t", "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"s2", "[", "t", "]"}], "2"]}]]}], ")"}]}], "0"},
     {
      FractionBox[
       RowBox[{"4", " ", "g", " ", "kd", " ", "us", " ", 
        RowBox[{"s1", "[", "t", "]"}], " ", 
        RowBox[{"s2", "[", "t", "]"}]}], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox[
           RowBox[{"s1", "[", "t", "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"s2", "[", "t", "]"}], "2"]}], ")"}], "2"]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "g", " ", "kd", " ", "us", " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           SuperscriptBox[
            RowBox[{"s1", "[", "t", "]"}], "2"], "-", 
           SuperscriptBox[
            RowBox[{"s2", "[", "t", "]"}], "2"]}], ")"}]}], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", 
           SuperscriptBox[
            RowBox[{"s1", "[", "t", "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"s2", "[", "t", "]"}], "2"]}], ")"}], "2"]]}], 
      RowBox[{"kd", " ", "us", " ", "\[Omega]3"}], 
      RowBox[{
       SuperscriptBox["kd", "2"], " ", 
       SuperscriptBox["us", "2"]}], 
      RowBox[{
       RowBox[{"-", "kd"}], " ", "us", " ", "\[Omega]1"}], "0", "0", "0", "0", 
      RowBox[{"us", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", "kd", " ", "us", " ", "v2"}], "-", 
         RowBox[{"v3", " ", "\[Omega]1"}], "+", 
         RowBox[{"v1", " ", "\[Omega]3"}], "-", 
         FractionBox[
          RowBox[{"2", " ", "g", " ", 
           RowBox[{"s2", "[", "t", "]"}]}], 
          RowBox[{"1", "+", 
           SuperscriptBox[
            RowBox[{"s1", "[", "t", "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"s2", "[", "t", "]"}], "2"]}]]}], ")"}]}], "0"},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{"4", " ", "g", " ", "kz", " ", "u3", " ", 
         RowBox[{"s1", "[", "t", "]"}]}], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", 
           SuperscriptBox[
            RowBox[{"s1", "[", "t", "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"s2", "[", "t", "]"}], "2"]}], ")"}], "2"]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"4", " ", "g", " ", "kz", " ", "u3", " ", 
         RowBox[{"s2", "[", "t", "]"}]}], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", 
           SuperscriptBox[
            RowBox[{"s1", "[", "t", "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"s2", "[", "t", "]"}], "2"]}], ")"}], "2"]]}], 
      RowBox[{
       RowBox[{"-", "kz"}], " ", "u3", " ", "\[Omega]2"}], 
      RowBox[{"kz", " ", "u3", " ", "\[Omega]1"}], 
      RowBox[{
       SuperscriptBox["kz", "2"], " ", "u3", " ", "us"}], "0", "0", "0", "0", 
      "0", 
      RowBox[{"u3", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", "kz", " ", "us", " ", "v3"}], "+", 
         RowBox[{"v2", " ", "\[Omega]1"}], "-", 
         RowBox[{"v1", " ", "\[Omega]2"}], "-", 
         FractionBox[
          RowBox[{"g", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             SuperscriptBox[
              RowBox[{"s1", "[", "t", "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"s2", "[", "t", "]"}], "2"]}], ")"}]}], 
          RowBox[{"1", "+", 
           SuperscriptBox[
            RowBox[{"s1", "[", "t", "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"s2", "[", "t", "]"}], "2"]}]]}], ")"}]}]},
     {"0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{
       RowBox[{"-", "kz"}], " ", "u3"}], "0", 
      RowBox[{
       RowBox[{"-", "kf"}], " ", "u3"}]},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "g", " ", "kd", " ", "us", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"kd", " ", "us", " ", 
            SuperscriptBox[
             RowBox[{"s1", "[", "t", "]"}], "2"]}], "-", 
           RowBox[{"4", " ", 
            RowBox[{"s1", "[", "t", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"\[Omega]2", "+", 
              RowBox[{"\[Omega]3", " ", 
               RowBox[{"s2", "[", "t", "]"}]}]}], ")"}]}], "-", 
           RowBox[{"kd", " ", "us", " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              SuperscriptBox[
               RowBox[{"s2", "[", "t", "]"}], "2"]}], ")"}]}]}], ")"}]}], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", 
           SuperscriptBox[
            RowBox[{"s1", "[", "t", "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"s2", "[", "t", "]"}], "2"]}], ")"}], "2"]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"4", " ", "g", " ", "kd", " ", "us", " ", 
         RowBox[{"(", 
          RowBox[{"\[Omega]3", "+", 
           RowBox[{"\[Omega]3", " ", 
            SuperscriptBox[
             RowBox[{"s1", "[", "t", "]"}], "2"]}], "-", 
           RowBox[{"2", " ", "\[Omega]2", " ", 
            RowBox[{"s2", "[", "t", "]"}]}], "+", 
           RowBox[{"kd", " ", "us", " ", 
            RowBox[{"s1", "[", "t", "]"}], " ", 
            RowBox[{"s2", "[", "t", "]"}]}], "-", 
           RowBox[{"\[Omega]3", " ", 
            SuperscriptBox[
             RowBox[{"s2", "[", "t", "]"}], "2"]}]}], ")"}]}], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", 
           SuperscriptBox[
            RowBox[{"s1", "[", "t", "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"s2", "[", "t", "]"}], "2"]}], ")"}], "2"]]}], 
      RowBox[{"kd", " ", "us", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           SuperscriptBox["kd", "2"]}], " ", 
          SuperscriptBox["us", "2"]}], "+", 
         SuperscriptBox["\[Omega]2", "2"], "+", 
         SuperscriptBox["\[Omega]3", "2"]}], ")"}]}], 
      RowBox[{"kd", " ", "us", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "\[Omega]1"}], " ", "\[Omega]2"}], "+", 
         RowBox[{"2", " ", "kd", " ", "us", " ", "\[Omega]3"}]}], ")"}]}], 
      RowBox[{
       RowBox[{"-", "kd"}], " ", "us", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"kd", " ", "us", " ", "\[Omega]2"}], "+", 
         RowBox[{"kz", " ", "us", " ", "\[Omega]2"}], "+", 
         RowBox[{"\[Omega]1", " ", "\[Omega]3"}]}], ")"}]}], "0", "0", "0", 
      "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"us", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"3", " ", 
            SuperscriptBox["kd", "2"], " ", 
            SuperscriptBox["us", "2"], " ", "v1"}], "+", 
           RowBox[{"2", " ", "g", " ", "\[Omega]2"}], "+", 
           RowBox[{"2", " ", "kd", " ", "us", " ", "v3", " ", "\[Omega]2"}], 
           "+", 
           RowBox[{"kz", " ", "us", " ", "v3", " ", "\[Omega]2"}], "+", 
           RowBox[{"v2", " ", "\[Omega]1", " ", "\[Omega]2"}], "-", 
           RowBox[{"v1", " ", 
            SuperscriptBox["\[Omega]2", "2"]}], "-", 
           RowBox[{"4", " ", "kd", " ", "us", " ", "v2", " ", "\[Omega]3"}], 
           "+", 
           RowBox[{"v3", " ", "\[Omega]1", " ", "\[Omega]3"}], "-", 
           RowBox[{"v1", " ", 
            SuperscriptBox["\[Omega]3", "2"]}], "-", 
           RowBox[{"4", " ", "g", " ", "kd", " ", "us", " ", 
            RowBox[{"s1", "[", "t", "]"}]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"3", " ", 
               SuperscriptBox["kd", "2"], " ", 
               SuperscriptBox["us", "2"], " ", "v1"}], "-", 
              RowBox[{"2", " ", "g", " ", "\[Omega]2"}], "+", 
              RowBox[{"kz", " ", "us", " ", "v3", " ", "\[Omega]2"}], "+", 
              RowBox[{"v2", " ", "\[Omega]1", " ", "\[Omega]2"}], "-", 
              RowBox[{"v1", " ", 
               SuperscriptBox["\[Omega]2", "2"]}], "+", 
              RowBox[{"v3", " ", "\[Omega]1", " ", "\[Omega]3"}], "-", 
              RowBox[{"v1", " ", 
               SuperscriptBox["\[Omega]3", "2"]}], "+", 
              RowBox[{"2", " ", "kd", " ", "us", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"v3", " ", "\[Omega]2"}], "-", 
                 RowBox[{"2", " ", "v2", " ", "\[Omega]3"}]}], ")"}]}]}], 
             ")"}], " ", 
            SuperscriptBox[
             RowBox[{"s1", "[", "t", "]"}], "2"]}], "+", 
           RowBox[{"4", " ", "g", " ", "\[Omega]3", " ", 
            RowBox[{"s2", "[", "t", "]"}]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"3", " ", 
               SuperscriptBox["kd", "2"], " ", 
               SuperscriptBox["us", "2"], " ", "v1"}], "-", 
              RowBox[{"2", " ", "g", " ", "\[Omega]2"}], "+", 
              RowBox[{
              "2", " ", "kd", " ", "us", " ", "v3", " ", "\[Omega]2"}], "+", 
              RowBox[{"kz", " ", "us", " ", "v3", " ", "\[Omega]2"}], "+", 
              RowBox[{"v2", " ", "\[Omega]1", " ", "\[Omega]2"}], "-", 
              RowBox[{"v1", " ", 
               SuperscriptBox["\[Omega]2", "2"]}], "-", 
              RowBox[{
              "4", " ", "kd", " ", "us", " ", "v2", " ", "\[Omega]3"}], "+", 
              RowBox[{"v3", " ", "\[Omega]1", " ", "\[Omega]3"}], "-", 
              RowBox[{"v1", " ", 
               SuperscriptBox["\[Omega]3", "2"]}]}], ")"}], " ", 
            SuperscriptBox[
             RowBox[{"s2", "[", "t", "]"}], "2"]}]}], ")"}]}], 
        RowBox[{"1", "+", 
         SuperscriptBox[
          RowBox[{"s1", "[", "t", "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"s2", "[", "t", "]"}], "2"]}]]}], 
      RowBox[{
       RowBox[{"-", "kd"}], " ", 
       SuperscriptBox["us", "2"], " ", "v3", " ", "\[Omega]2"}]},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{"4", " ", "g", " ", "kd", " ", "us", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"\[Omega]3", " ", 
            SuperscriptBox[
             RowBox[{"s1", "[", "t", "]"}], "2"]}], "+", 
           RowBox[{
            RowBox[{"s1", "[", "t", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", "\[Omega]1"}], "+", 
              RowBox[{"kd", " ", "us", " ", 
               RowBox[{"s2", "[", "t", "]"}]}]}], ")"}]}], "-", 
           RowBox[{"\[Omega]3", " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              SuperscriptBox[
               RowBox[{"s2", "[", "t", "]"}], "2"]}], ")"}]}]}], ")"}]}], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", 
           SuperscriptBox[
            RowBox[{"s1", "[", "t", "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"s2", "[", "t", "]"}], "2"]}], ")"}], "2"]]}], 
      FractionBox[
       RowBox[{"2", " ", "g", " ", "kd", " ", "us", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"kd", " ", "us"}], "+", 
          RowBox[{"kd", " ", "us", " ", 
           SuperscriptBox[
            RowBox[{"s1", "[", "t", "]"}], "2"]}], "-", 
          RowBox[{"4", " ", "\[Omega]1", " ", 
           RowBox[{"s2", "[", "t", "]"}]}], "-", 
          RowBox[{"4", " ", "\[Omega]3", " ", 
           RowBox[{"s1", "[", "t", "]"}], " ", 
           RowBox[{"s2", "[", "t", "]"}]}], "-", 
          RowBox[{"kd", " ", "us", " ", 
           SuperscriptBox[
            RowBox[{"s2", "[", "t", "]"}], "2"]}]}], ")"}]}], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox[
           RowBox[{"s1", "[", "t", "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"s2", "[", "t", "]"}], "2"]}], ")"}], "2"]], 
      RowBox[{
       RowBox[{"-", "kd"}], " ", "us", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Omega]1", " ", "\[Omega]2"}], "+", 
         RowBox[{"2", " ", "kd", " ", "us", " ", "\[Omega]3"}]}], ")"}]}], 
      RowBox[{"kd", " ", "us", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           SuperscriptBox["kd", "2"]}], " ", 
          SuperscriptBox["us", "2"]}], "+", 
         SuperscriptBox["\[Omega]1", "2"], "+", 
         SuperscriptBox["\[Omega]3", "2"]}], ")"}]}], 
      RowBox[{"kd", " ", "us", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"kd", " ", "us", " ", "\[Omega]1"}], "+", 
         RowBox[{"kz", " ", "us", " ", "\[Omega]1"}], "-", 
         RowBox[{"\[Omega]2", " ", "\[Omega]3"}]}], ")"}]}], "0", "0", "0", 
      "0", 
      FractionBox[
       RowBox[{"us", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "3"}], " ", 
           SuperscriptBox["kd", "2"], " ", 
           SuperscriptBox["us", "2"], " ", "v2"}], "+", 
          RowBox[{"2", " ", "g", " ", "\[Omega]1"}], "+", 
          RowBox[{"2", " ", "kd", " ", "us", " ", "v3", " ", "\[Omega]1"}], 
          "+", 
          RowBox[{"kz", " ", "us", " ", "v3", " ", "\[Omega]1"}], "+", 
          RowBox[{"v2", " ", 
           SuperscriptBox["\[Omega]1", "2"]}], "-", 
          RowBox[{"v1", " ", "\[Omega]1", " ", "\[Omega]2"}], "-", 
          RowBox[{"4", " ", "kd", " ", "us", " ", "v1", " ", "\[Omega]3"}], 
          "-", 
          RowBox[{"v3", " ", "\[Omega]2", " ", "\[Omega]3"}], "+", 
          RowBox[{"v2", " ", 
           SuperscriptBox["\[Omega]3", "2"]}], "+", 
          RowBox[{"4", " ", "g", " ", "\[Omega]3", " ", 
           RowBox[{"s1", "[", "t", "]"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "3"}], " ", 
              SuperscriptBox["kd", "2"], " ", 
              SuperscriptBox["us", "2"], " ", "v2"}], "-", 
             RowBox[{"2", " ", "g", " ", "\[Omega]1"}], "+", 
             RowBox[{"kz", " ", "us", " ", "v3", " ", "\[Omega]1"}], "+", 
             RowBox[{"v2", " ", 
              SuperscriptBox["\[Omega]1", "2"]}], "-", 
             RowBox[{"v1", " ", "\[Omega]1", " ", "\[Omega]2"}], "-", 
             RowBox[{"v3", " ", "\[Omega]2", " ", "\[Omega]3"}], "+", 
             RowBox[{"v2", " ", 
              SuperscriptBox["\[Omega]3", "2"]}], "+", 
             RowBox[{"2", " ", "kd", " ", "us", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"v3", " ", "\[Omega]1"}], "-", 
                RowBox[{"2", " ", "v1", " ", "\[Omega]3"}]}], ")"}]}]}], 
            ")"}], " ", 
           SuperscriptBox[
            RowBox[{"s1", "[", "t", "]"}], "2"]}], "+", 
          RowBox[{"4", " ", "g", " ", "kd", " ", "us", " ", 
           RowBox[{"s2", "[", "t", "]"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "3"}], " ", 
              SuperscriptBox["kd", "2"], " ", 
              SuperscriptBox["us", "2"], " ", "v2"}], "-", 
             RowBox[{"2", " ", "g", " ", "\[Omega]1"}], "+", 
             RowBox[{"2", " ", "kd", " ", "us", " ", "v3", " ", "\[Omega]1"}],
              "+", 
             RowBox[{"kz", " ", "us", " ", "v3", " ", "\[Omega]1"}], "+", 
             RowBox[{"v2", " ", 
              SuperscriptBox["\[Omega]1", "2"]}], "-", 
             RowBox[{"v1", " ", "\[Omega]1", " ", "\[Omega]2"}], "-", 
             RowBox[{"4", " ", "kd", " ", "us", " ", "v1", " ", "\[Omega]3"}],
              "-", 
             RowBox[{"v3", " ", "\[Omega]2", " ", "\[Omega]3"}], "+", 
             RowBox[{"v2", " ", 
              SuperscriptBox["\[Omega]3", "2"]}]}], ")"}], " ", 
           SuperscriptBox[
            RowBox[{"s2", "[", "t", "]"}], "2"]}]}], ")"}]}], 
       RowBox[{"1", "+", 
        SuperscriptBox[
         RowBox[{"s1", "[", "t", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"s2", "[", "t", "]"}], "2"]}]], 
      RowBox[{"kd", " ", 
       SuperscriptBox["us", "2"], " ", "v3", " ", "\[Omega]1"}]},
     {
      FractionBox[
       RowBox[{"4", " ", "g", " ", "kz", " ", "u3", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Omega]2", " ", 
           SuperscriptBox[
            RowBox[{"s1", "[", "t", "]"}], "2"]}], "+", 
          RowBox[{
           RowBox[{"s1", "[", "t", "]"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"kz", " ", "us"}], "-", 
             RowBox[{"2", " ", "\[Omega]1", " ", 
              RowBox[{"s2", "[", "t", "]"}]}]}], ")"}]}], "-", 
          RowBox[{"\[Omega]2", " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             SuperscriptBox[
              RowBox[{"s2", "[", "t", "]"}], "2"]}], ")"}]}]}], ")"}]}], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox[
           RowBox[{"s1", "[", "t", "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"s2", "[", "t", "]"}], "2"]}], ")"}], "2"]], 
      FractionBox[
       RowBox[{"4", " ", "g", " ", "kz", " ", "u3", " ", 
        RowBox[{"(", 
         RowBox[{"\[Omega]1", "+", 
          RowBox[{"\[Omega]1", " ", 
           SuperscriptBox[
            RowBox[{"s1", "[", "t", "]"}], "2"]}], "+", 
          RowBox[{"kz", " ", "us", " ", 
           RowBox[{"s2", "[", "t", "]"}]}], "+", 
          RowBox[{"2", " ", "\[Omega]2", " ", 
           RowBox[{"s1", "[", "t", "]"}], " ", 
           RowBox[{"s2", "[", "t", "]"}]}], "-", 
          RowBox[{"\[Omega]1", " ", 
           SuperscriptBox[
            RowBox[{"s2", "[", "t", "]"}], "2"]}]}], ")"}]}], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox[
           RowBox[{"s1", "[", "t", "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"s2", "[", "t", "]"}], "2"]}], ")"}], "2"]], 
      RowBox[{"kz", " ", "u3", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"kd", " ", "us", " ", "\[Omega]2"}], "+", 
         RowBox[{"kz", " ", "us", " ", "\[Omega]2"}], "-", 
         RowBox[{"\[Omega]1", " ", "\[Omega]3"}]}], ")"}]}], 
      RowBox[{
       RowBox[{"-", "kz"}], " ", "u3", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"kd", " ", "us", " ", "\[Omega]1"}], "+", 
         RowBox[{"kz", " ", "us", " ", "\[Omega]1"}], "+", 
         RowBox[{"\[Omega]2", " ", "\[Omega]3"}]}], ")"}]}], 
      RowBox[{"kz", " ", "u3", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           SuperscriptBox["kz", "2"]}], " ", 
          SuperscriptBox["us", "2"]}], "+", 
         SuperscriptBox["\[Omega]1", "2"], "+", 
         SuperscriptBox["\[Omega]2", "2"]}], ")"}]}], "0", "0", "0", "0", 
      RowBox[{"kz", " ", "u3", " ", "us", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "v2"}], " ", "\[Omega]1"}], "+", 
         RowBox[{"v1", " ", "\[Omega]2"}]}], ")"}]}], 
      FractionBox[
       RowBox[{"u3", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", "g", " ", "kz", " ", "us"}], "-", 
          RowBox[{"3", " ", 
           SuperscriptBox["kz", "2"], " ", 
           SuperscriptBox["us", "2"], " ", "v3"}], "-", 
          RowBox[{"kd", " ", "us", " ", "v2", " ", "\[Omega]1"}], "-", 
          RowBox[{"2", " ", "kz", " ", "us", " ", "v2", " ", "\[Omega]1"}], 
          "+", 
          RowBox[{"v3", " ", 
           SuperscriptBox["\[Omega]1", "2"]}], "+", 
          RowBox[{"kd", " ", "us", " ", "v1", " ", "\[Omega]2"}], "+", 
          RowBox[{"2", " ", "kz", " ", "us", " ", "v1", " ", "\[Omega]2"}], 
          "+", 
          RowBox[{"v3", " ", 
           SuperscriptBox["\[Omega]2", "2"]}], "-", 
          RowBox[{"v1", " ", "\[Omega]1", " ", "\[Omega]3"}], "-", 
          RowBox[{"v2", " ", "\[Omega]2", " ", "\[Omega]3"}], "-", 
          RowBox[{"4", " ", "g", " ", "\[Omega]2", " ", 
           RowBox[{"s1", "[", "t", "]"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", "g", " ", "kz", " ", "us"}], "-", 
             RowBox[{"3", " ", 
              SuperscriptBox["kz", "2"], " ", 
              SuperscriptBox["us", "2"], " ", "v3"}], "-", 
             RowBox[{"kd", " ", "us", " ", "v2", " ", "\[Omega]1"}], "-", 
             RowBox[{"2", " ", "kz", " ", "us", " ", "v2", " ", "\[Omega]1"}],
              "+", 
             RowBox[{"v3", " ", 
              SuperscriptBox["\[Omega]1", "2"]}], "+", 
             RowBox[{"kd", " ", "us", " ", "v1", " ", "\[Omega]2"}], "+", 
             RowBox[{"2", " ", "kz", " ", "us", " ", "v1", " ", "\[Omega]2"}],
              "+", 
             RowBox[{"v3", " ", 
              SuperscriptBox["\[Omega]2", "2"]}], "-", 
             RowBox[{"v1", " ", "\[Omega]1", " ", "\[Omega]3"}], "-", 
             RowBox[{"v2", " ", "\[Omega]2", " ", "\[Omega]3"}]}], ")"}], " ", 
           SuperscriptBox[
            RowBox[{"s1", "[", "t", "]"}], "2"]}], "+", 
          RowBox[{"4", " ", "g", " ", "\[Omega]1", " ", 
           RowBox[{"s2", "[", "t", "]"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", "g", " ", "kz", " ", "us"}], "-", 
             RowBox[{"3", " ", 
              SuperscriptBox["kz", "2"], " ", 
              SuperscriptBox["us", "2"], " ", "v3"}], "-", 
             RowBox[{"kd", " ", "us", " ", "v2", " ", "\[Omega]1"}], "-", 
             RowBox[{"2", " ", "kz", " ", "us", " ", "v2", " ", "\[Omega]1"}],
              "+", 
             RowBox[{"v3", " ", 
              SuperscriptBox["\[Omega]1", "2"]}], "+", 
             RowBox[{"kd", " ", "us", " ", "v1", " ", "\[Omega]2"}], "+", 
             RowBox[{"2", " ", "kz", " ", "us", " ", "v1", " ", "\[Omega]2"}],
              "+", 
             RowBox[{"v3", " ", 
              SuperscriptBox["\[Omega]2", "2"]}], "-", 
             RowBox[{"v1", " ", "\[Omega]1", " ", "\[Omega]3"}], "-", 
             RowBox[{"v2", " ", "\[Omega]2", " ", "\[Omega]3"}]}], ")"}], " ", 
           SuperscriptBox[
            RowBox[{"s2", "[", "t", "]"}], "2"]}]}], ")"}]}], 
       RowBox[{"1", "+", 
        SuperscriptBox[
         RowBox[{"s1", "[", "t", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"s2", "[", "t", "]"}], "2"]}]]},
     {"0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"kd", " ", "us", " ", "\[Omega]2"}], 
      RowBox[{"kf", " ", "us", " ", "\[Omega]2"}], "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{
       RowBox[{"-", "kd"}], " ", "us", " ", "\[Omega]1"}], 
      RowBox[{
       RowBox[{"-", "kf"}], " ", "us", " ", "\[Omega]1"}], "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{
       SuperscriptBox["kz", "2"], " ", "u3", " ", "us"}], "0", 
      RowBox[{"2", " ", "kf", " ", "kz", " ", "u3", " ", "us"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.7511175629995117`*^9, 3.751117580778759*^9}, 
   3.751550018635086*^9, 3.751550086214903*^9, {3.751550134381053*^9, 
   3.751550139329938*^9}, {3.75155022045936*^9, 3.751550239238613*^9}, 
   3.7515502745862217`*^9, {3.751550318484446*^9, 3.751550342229746*^9}, 
   3.7515504291241083`*^9, 3.751550532071961*^9, {3.7515517582714767`*^9, 
   3.7515517803483677`*^9}, 3.751551825230111*^9, {3.7515518586202917`*^9, 
   3.751551878870764*^9}, 3.751551931472127*^9, {3.751552008875745*^9, 
   3.751552030307026*^9}, 3.751552065793494*^9, {3.751552169619228*^9, 
   3.751552248699203*^9}, 3.751553567855927*^9, 3.856979998121644*^9, 
   3.856980071525917*^9, 3.856980117213175*^9},
 CellLabel->
  "Out[30]//MatrixForm=",ExpressionUUID->"c83cd054-8208-42d8-81e9-\
8a3f364a23d2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"MatrixRank", "[", "o", "]"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "the", " ", "observability", " ", "matrix", " ", "is", " ", "full", " ", 
    "rank"}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.751117572119628*^9, 3.7511176128595657`*^9}},
 CellLabel->"In[31]:=",ExpressionUUID->"defc15c4-6ae9-4a6c-8fa0-1afae3844152"],

Cell[BoxData["11"], "Output",
 CellChangeTimes->{
  3.751117581096965*^9, 3.751550018850272*^9, 3.75155008627312*^9, {
   3.751550134416541*^9, 3.751550139368021*^9}, {3.751550220501587*^9, 
   3.7515502392794943`*^9}, 3.751550274630221*^9, {3.7515503185275373`*^9, 
   3.751550342269025*^9}, 3.751550429160524*^9, 3.751550532110908*^9, {
   3.751551758311441*^9, 3.751551780413887*^9}, 3.7515518252884398`*^9, {
   3.751551858680341*^9, 3.7515518789352913`*^9}, 3.751551931555868*^9, {
   3.751552009727223*^9, 3.7515520311990223`*^9}, 3.751552066637349*^9, {
   3.751552170559648*^9, 3.751552248935646*^9}, 3.751553568092448*^9, 
   3.856979998599134*^9, 3.8569800725843887`*^9, 3.856980118506712*^9},
 CellLabel->"Out[31]=",ExpressionUUID->"923c35a9-bf47-4e5d-86e8-0e01d3f7fca0"]
}, Open  ]],

Cell[BoxData["Quit"], "Input",
 CellChangeTimes->{{3.7515517691153584`*^9, 3.751551769779072*^9}},
 CellLabel->"In[32]:=",ExpressionUUID->"b9cb7beb-e8bf-4964-86ea-11313f98cdf5"]
}, Open  ]]
},
WindowSize->{1386, 762},
WindowMargins->{{0, Automatic}, {0, Automatic}},
FrontEndVersion->"13.0 for Linux x86 (64-bit) (December 2, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"96620fee-e0d0-4e33-956e-4289a12bb566"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 192, 3, 73, "Text",ExpressionUUID->"f394c52c-92c2-4904-b692-f42fc6e2de3d"],
Cell[753, 25, 238, 4, 35, "Text",ExpressionUUID->"c7d5ddad-8ade-4b71-9428-375a1259f787"],
Cell[994, 31, 430, 9, 58, "Text",ExpressionUUID->"eb048bfe-27f4-4cba-82b7-1dc2e90a517d"],
Cell[CellGroupData[{
Cell[1449, 44, 172, 3, 68, "Section",ExpressionUUID->"074b8c9b-476d-4d68-9aaa-1187533a5261"],
Cell[1624, 49, 310, 7, 35, "Text",ExpressionUUID->"8a73ebba-5df7-4271-b4c3-04d996b8e788"],
Cell[1937, 58, 1857, 49, 29, "Input",ExpressionUUID->"9f38658d-6ee7-45e4-8dbf-0b56336ac469"],
Cell[3797, 109, 519, 12, 29, "Input",ExpressionUUID->"f267fd17-b3a2-414c-9932-2e9c7b1fea4a"],
Cell[4319, 123, 627, 16, 29, "Input",ExpressionUUID->"55f57c85-8a69-4b57-9c36-87bebbf3eac8"],
Cell[4949, 141, 848, 21, 29, "Input",ExpressionUUID->"35effb2f-0e43-44f5-b8ba-1c933b005854"],
Cell[5800, 164, 548, 12, 32, "Input",ExpressionUUID->"433d4622-7eab-4a78-a5e2-ac6361e3e096"],
Cell[6351, 178, 1145, 34, 29, "Input",ExpressionUUID->"7b5a3a50-a507-4f3c-834f-07c3a9848814"],
Cell[7499, 214, 773, 18, 29, "Input",ExpressionUUID->"24865bb4-33b7-4573-a9ab-eef82c207cf5"],
Cell[8275, 234, 1212, 29, 29, "Input",ExpressionUUID->"f21e1ac9-836c-4baf-907f-ea75b03633ab"],
Cell[9490, 265, 720, 16, 29, "Input",ExpressionUUID->"35726f7d-bb5e-4bf9-ae30-e9e98e696b5a"],
Cell[CellGroupData[{
Cell[10235, 285, 210, 3, 29, "Input",ExpressionUUID->"9278849e-4d0c-4eb7-b6d6-73a389af6b01"],
Cell[10448, 290, 8136, 219, 129, "Output",ExpressionUUID->"1d9b60c9-2722-47c1-92cd-7ffba75c299b"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[18633, 515, 257, 4, 68, "Section",ExpressionUUID->"7e440c57-b826-43a1-b274-70858315908b"],
Cell[18893, 521, 298, 6, 35, "Text",ExpressionUUID->"1c058ca5-fbe4-40ff-8c9a-734503dfe586"],
Cell[19194, 529, 945, 18, 29, "Input",ExpressionUUID->"f6115044-be6b-46a3-a9b3-ab977a9e477a"],
Cell[20142, 549, 741, 21, 29, "Input",ExpressionUUID->"ee6a28fc-c56d-4b92-b8a5-4b0bde487982"],
Cell[CellGroupData[{
Cell[20908, 574, 1195, 30, 29, "Input",ExpressionUUID->"de24fdd9-a7eb-4cb0-bc6d-91d01f670942"],
Cell[22106, 606, 2078, 56, 47, "Output",ExpressionUUID->"e63e0fda-636e-47df-aa31-6e24920b6033"]
}, Open  ]],
Cell[24199, 665, 1730, 30, 29, "Input",ExpressionUUID->"3fdd5045-45c0-4679-89af-fbc071261350"],
Cell[25932, 697, 1985, 39, 29, "Input",ExpressionUUID->"1ceb89bc-7a9e-4369-9571-a93da7c6ebba"],
Cell[27920, 738, 637, 17, 29, "Input",ExpressionUUID->"02799d5f-b064-45a4-9b7f-90950d7d501a"],
Cell[28560, 757, 1056, 24, 29, "Input",ExpressionUUID->"9bd2d820-fd0e-462d-841a-c04bc9be8e76"],
Cell[29619, 783, 2391, 43, 29, "Input",ExpressionUUID->"dbbc97cc-84ad-4746-ade2-82e0da74c972"],
Cell[CellGroupData[{
Cell[32035, 830, 697, 14, 29, "Input",ExpressionUUID->"33025bef-b023-4c0b-86cd-f939497a4d28"],
Cell[32735, 846, 3846, 97, 92, "Output",ExpressionUUID->"92ee3503-bb2b-47ad-ac1e-3875c2e35965"]
}, Open  ]],
Cell[CellGroupData[{
Cell[36618, 948, 804, 16, 29, "Input",ExpressionUUID->"45a79a51-2bc4-4858-8447-4567ae1c43e7"],
Cell[37425, 966, 1289, 20, 33, "Output",ExpressionUUID->"bffd52c7-94ae-436a-8ca1-a9d2e88b0701"]
}, Open  ]],
Cell[38729, 989, 752, 20, 29, "Input",ExpressionUUID->"fc5a9085-3e98-47d1-a398-4da5a1ad1f22"]
}, Open  ]],
Cell[CellGroupData[{
Cell[39518, 1014, 191, 3, 68, "Section",ExpressionUUID->"554272a7-2b52-4f82-bd29-47b34a6747f6"],
Cell[39712, 1019, 198, 3, 35, "Text",ExpressionUUID->"6149a945-d25b-4471-98ef-2c87f09744cf"],
Cell[39913, 1024, 403, 10, 29, "Input",ExpressionUUID->"e4cf1648-9e94-4281-bdef-470eeb9e2687"],
Cell[CellGroupData[{
Cell[40341, 1038, 1099, 20, 29, "Input",ExpressionUUID->"cfc5a84c-2ad2-4718-9a06-feb75f03dff3"],
Cell[41443, 1060, 2764, 70, 57, "Output",ExpressionUUID->"4447013f-a8f1-4b49-8228-2dfd92fe4708"]
}, Open  ]],
Cell[CellGroupData[{
Cell[44244, 1135, 710, 15, 29, "Input",ExpressionUUID->"cb369cce-5d00-46ef-810e-f13d32684c65"],
Cell[44957, 1152, 990, 16, 33, "Output",ExpressionUUID->"49e79790-1032-4952-b119-8c556790d25a"]
}, Open  ]],
Cell[45962, 1171, 1049, 22, 29, "Input",ExpressionUUID->"a08bdb2a-cb2e-4568-b716-d7060da2c723"],
Cell[47014, 1195, 830, 17, 29, "Input",ExpressionUUID->"8d7bf188-19ce-437e-aeab-b569f0c532c2"],
Cell[47847, 1214, 1670, 27, 29, "Input",ExpressionUUID->"4a600330-f3dd-498a-be72-d333c236285d"],
Cell[49520, 1243, 569, 12, 29, "Input",ExpressionUUID->"faa061a9-b6b1-4fa9-8272-70eb741883f4"],
Cell[50092, 1257, 861, 17, 29, "Input",ExpressionUUID->"3b8d99c4-b886-4b73-bf59-2f5b42f37590"],
Cell[CellGroupData[{
Cell[50978, 1278, 208, 3, 29, "Input",ExpressionUUID->"a2ade8c6-d4e7-4b3e-a7c4-4dc427e180e8"],
Cell[51189, 1283, 26303, 647, 388, "Output",ExpressionUUID->"c83cd054-8208-42d8-81e9-8a3f364a23d2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[77529, 1935, 367, 8, 29, "Input",ExpressionUUID->"defc15c4-6ae9-4a6c-8fa0-1afae3844152"],
Cell[77899, 1945, 782, 11, 33, "Output",ExpressionUUID->"923c35a9-bf47-4e5d-86e8-0e01d3f7fca0"]
}, Open  ]],
Cell[78696, 1959, 177, 2, 29, "Input",ExpressionUUID->"b9cb7beb-e8bf-4964-86ea-11313f98cdf5"]
}, Open  ]]
}
]
*)

